var scrollTop = 0,
    lastScrollTop = 0,
    canvas, ctx,
		cw, ch,
		hw, hh,
		mouseX = 0,
    mouseY = 0,
    lQueue = null,
		queue  = null,
		wait   = 100;

var HEX_NUM_ANGLES    = 6,
    HEX_MAX_IN_RADIUS = 0.0,
    HEX_MAX_RADIUS    = 0.0,
    radius            = [],
    selRadius         = 0.0;

var HEX_BG_PALLET = [
  ["rgb(240,155,165)","rgb(249,218,217)","rgb(240,155,165)","rgb(238,132,140)","rgb(238,132,140)","rgb(249,218,217)","rgb(162,179,219)","rgb(162,179,219)","rgb(58,67,152)","rgb(116,131,192)","rgb(222,234,247)"],
  ["rgb(238,132,140)","rgb(240,155,165)","rgb(249,218,217)","rgb(222,234,247)","rgb(255,251,208)","rgb(249,218,217)","rgb(116,131,192)","rgb(116,131,192)","rgb(58,67,152)","rgb(116,131,192)","rgb(58,67,152)","rgb(116,131,192)"],
  ["rgb(238,132,140)","rgb(249,218,217)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(249,218,217)","rgb(240,155,165)","rgb(58,67,152)","rgb(232,84,107)","rgb(232,84,107)","rgb(74,74,156)"],
  ["rgb(255,251,208)","rgb(255,252,228)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(222,234,247)","rgb(222,234,247)","rgb(240,155,165)","rgb(224,54,74)","rgb(232,84,107)","rgb(240,155,165)","rgb(74,74,156)"],
  ["rgb(222,234,247)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(249,218,217)","rgb(240,155,165)","rgb(232,84,107)","rgb(224,54,74)","rgb(240,155,165)","rgb(240,155,165)"],
  ["rgb(222,234,247)","rgb(222,234,247)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,246,151)","rgb(232,84,107)","rgb(224,54,74)","rgb(232,84,107)","rgb(232,84,107)","rgb(116,131,192)"],
  ["rgb(249,218,217)","rgb(249,218,217)","rgb(255,252,228)","rgb(255,255,255)","rgb(222,234,247)","rgb(162,179,219)","rgb(240,155,165)","rgb(224,54,74)","rgb(232,84,107)","rgb(240,155,165)","rgb(162,179,219)"],
  ["rgb(162,179,219)","rgb(249,218,217)","rgb(222,234,247)","rgb(255,252,228)","rgb(249,218,217)","rgb(249,218,217)","rgb(162,179,219)","rgb(74,74,156)","rgb(74,74,156)","rgb(240,155,165)","rgb(162,179,219)","rgb(66,90,166)"],
  ["rgb(162,179,219)","rgb(240,155,165)","rgb(249,218,217)","rgb(249,218,217)","rgb(240,155,165)","rgb(240,155,165)","rgb(66,90,166)","rgb(232,84,107)","rgb(162,179,219)","rgb(240,155,165)","rgb(232,84,107)"],
  ["rgb(132,109,174)","rgb(162,179,219)","rgb(240,155,165)","rgb(240,155,165)","rgb(238,132,140)","rgb(240,155,165)","rgb(238,132,140)","rgb(66,90,166)","rgb(232,84,107)","rgb(162,179,219)","rgb(224,54,74)","rgb(224,54,74)"],
  ["rgb(132,109,174)","rgb(238,132,140)","rgb(238,132,140)","rgb(222,129,140)","rgb(132,109,174)","rgb(123,89,162)","rgb(232,84,107)","rgb(232,84,107)","rgb(162,179,219)","rgb(232,84,107)","rgb(224,54,74)"],
  ["rgb(123,89,162)","rgb(74,74,156)","rgb(232,84,107)","rgb(217,70,78)","rgb(123,89,162)","rgb(123,89,162)","rgb(217,70,78)","rgb(232,84,107)","rgb(224,54,74)","rgb(66,90,166)","rgb(132,109,174)","rgb(132,109,174)"],
  ["rgb(123,89,162)","rgb(123,89,162)","rgb(224,54,74)","rgb(238,132,140)","rgb(224,54,74)","rgb(224,54,74)","rgb(249,218,217)","rgb(240,155,165)","rgb(217,70,78)","rgb(162,179,219)","rgb(123,89,162)"],
  ["rgb(232,84,107)","rgb(123,89,162)","rgb(224,54,74)","rgb(217,70,78)","rgb(224,54,74)","rgb(240,155,165)","rgb(249,218,217)","rgb(249,218,217)","rgb(217,70,78)","rgb(232,84,107)","rgb(123,89,162)","rgb(123,89,162)"],
  ["rgb(217,70,78)","rgb(224,54,74)","rgb(232,84,107)","rgb(232,84,107)","rgb(238,132,140)","rgb(255,252,228)","rgb(240,155,165)","rgb(240,155,165)","rgb(66,90,166)","rgb(162,179,219)","rgb(123,89,162)"],
  ["rgb(232,84,107)","rgb(232,84,107)","rgb(224,54,74)","rgb(240,155,165)","rgb(238,132,140)","rgb(249,218,217)","rgb(255,252,228)","rgb(249,218,217)","rgb(249,218,217)","rgb(222,234,247)","rgb(162,179,219)","rgb(74,74,156)"],
  ["rgb(232,84,107)","rgb(238,132,140)","rgb(238,132,140)","rgb(240,155,165)","rgb(249,218,217)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(222,234,247)","rgb(255,255,255)"],
  ["rgb(224,54,74)","rgb(232,84,107)","rgb(238,132,140)","rgb(255,255,255)","rgb(255,252,228)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(249,218,217)","rgb(232,84,107)"],
  ["rgb(217,70,78)","rgb(224,54,74)","rgb(249,218,217)","rgb(249,218,217)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(249,218,217)"],
  ["rgb(217,70,78)","rgb(123,89,162)","rgb(232,84,107)","rgb(255,255,255)","rgb(255,252,228)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(249,218,217)","rgb(240,155,165)"],
  ["rgb(232,84,107)","rgb(232,84,107)","rgb(255,255,255)","rgb(255,252,228)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(240,155,165)"],
  ["rgb(123,89,162)","rgb(162,179,219)","rgb(238,132,140)","rgb(238,132,140)","rgb(249,218,217)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,252,228)","rgb(240,155,165)"],
  ["rgb(132,109,174)","rgb(162,179,219)","rgb(238,132,140)","rgb(255,252,228)","rgb(249,218,217)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,252,228)","rgb(240,155,165)"],
  ["rgb(162,179,219)","rgb(240,155,165)","rgb(232,84,107)","rgb(240,155,165)","rgb(240,155,165)","rgb(240,155,165)","rgb(249,218,217)","rgb(255,252,228)","rgb(255,252,228)","rgb(249,218,217)","rgb(249,218,217)","rgb(240,155,165)"],
  ["rgb(66,90,166)","rgb(232,84,107)","rgb(232,84,107)","rgb(240,155,165)","rgb(238,132,140)","rgb(238,132,140)","rgb(238,132,140)","rgb(249,218,217)","rgb(240,155,165)","rgb(232,84,107)","rgb(132,109,174)"],
  ["rgb(66,90,166)","rgb(66,90,166)","rgb(224,54,74)","rgb(224,54,74)","rgb(232,84,107)","rgb(238,132,140)","rgb(232,84,107)","rgb(232,84,107)","rgb(217,70,78)","rgb(132,109,174)","rgb(123,89,162)","rgb(66,90,166)"],
  ["rgb(123,89,162)","rgb(224,54,74)","rgb(224,54,74)","rgb(238,132,140)","rgb(240,155,165)","rgb(132,109,174)","rgb(123,89,162)","rgb(238,132,140)","rgb(224,54,74)","rgb(224,54,74)","rgb(132,109,174)"],
  ["rgb(66,90,166)","rgb(132,109,174)","rgb(224,54,74)","rgb(232,84,107)","rgb(232,84,107)","rgb(238,132,140)","rgb(123,89,162)","rgb(123,89,162)","rgb(232,84,107)","rgb(224,54,74)","rgb(132,109,174)","rgb(132,109,174)"],
  ["rgb(123,89,162)","rgb(162,179,219)","rgb(132,109,174)","rgb(238,132,140)","rgb(240,155,165)","rgb(232,84,107)","rgb(232,84,107)","rgb(238,132,140)","rgb(232,84,107)","rgb(217,70,78)","rgb(238,132,140)"],
  ["rgb(162,179,219)","rgb(162,179,219)","rgb(222,234,247)","rgb(249,218,217)","rgb(249,218,217)","rgb(255,252,228)","rgb(249,218,217)","rgb(238,132,140)","rgb(240,155,165)","rgb(224,54,74)","rgb(232,84,107)","rgb(66,90,166)"],
  ["rgb(255,246,151)","rgb(222,234,247)","rgb(255,252,228)","rgb(249,218,217)","rgb(255,252,228)","rgb(255,252,228)","rgb(249,218,217)","rgb(240,155,165)","rgb(238,132,140)","rgb(162,179,219)","rgb(66,90,166)"],
  ["rgb(240,155,165)","rgb(249,218,217)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,252,228)","rgb(240,155,165)","rgb(238,132,140)","rgb(162,179,219)","rgb(66,90,166)"],
  ["rgb(249,218,217)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(249,218,217)","rgb(249,218,217)","rgb(224,54,74)","rgb(74,74,156)"],
  ["rgb(240,155,165)","rgb(249,218,217)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,252,228)","rgb(255,255,255)","rgb(255,255,255)","rgb(224,54,74)","rgb(217,70,78)"],
  ["rgb(240,155,165)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,252,228)","rgb(255,255,255)","rgb(123,89,162)","rgb(232,84,107)"],
  ["rgb(232,84,107)","rgb(255,252,228)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(249,218,217)","rgb(238,132,140)","rgb(238,132,140)","rgb(217,70,78)","rgb(123,89,162)"],
  ["rgb(240,155,165)","rgb(255,252,228)","rgb(255,252,228)","rgb(249,218,217)","rgb(249,218,217)","rgb(255,252,228)","rgb(249,218,217)","rgb(255,255,255)","rgb(238,132,140)","rgb(232,84,107)","rgb(123,89,162)"],
  ["rgb(224,54,74)","rgb(238,132,140)","rgb(240,155,165)","rgb(240,155,165)","rgb(238,132,140)","rgb(249,218,217)","rgb(240,155,165)","rgb(240,155,165)","rgb(240,155,165)","rgb(224,54,74)","rgb(132,109,174)","rgb(132,109,174)"],
  ["rgb(238,132,140)","rgb(238,132,140)","rgb(240,155,165)","rgb(249,218,217)","rgb(240,155,165)","rgb(238,132,140)","rgb(238,132,140)","rgb(238,132,140)","rgb(224,54,74)","rgb(224,54,74)","rgb(74,74,156)"],
  ["rgb(217,70,78)","rgb(255,255,255)","rgb(238,132,140)","rgb(255,246,151)","rgb(238,132,140)","rgb(240,155,165)","rgb(238,132,140)","rgb(240,155,165)","rgb(240,155,165)","rgb(224,54,74)","rgb(66,90,166)","rgb(66,90,166)"],
  ["rgb(255,252,228)","rgb(222,234,247)","rgb(249,218,217)","rgb(249,218,217)","rgb(255,252,228)","rgb(255,252,228)","rgb(249,218,217)","rgb(240,155,165)","rgb(249,218,217)","rgb(162,179,219)","rgb(162,179,219)"],
  ["rgb(240,155,165)","rgb(249,218,217)","rgb(222,234,247)","rgb(222,234,247)","rgb(249,218,217)","rgb(255,252,228)","rgb(249,218,217)","rgb(249,218,217)","rgb(162,179,219)","rgb(249,218,217)","rgb(255,252,228)","rgb(162,179,219)"],
  ["rgb(222,234,247)","rgb(39,134,187)","rgb(128,180,216)","rgb(252,209,62)","rgb(252,209,62)","rgb(166,145,196)","rgb(128,180,216)","rgb(166,145,196)","rgb(128,180,216)","rgb(39,134,187)","rgb(255,252,228)"],
  ["rgb(240,155,165)","rgb(252,209,62)","rgb(242,129,132)","rgb(241,154,164)","rgb(198,216,236)","rgb(216,205,228)","rgb(255,241,172)","rgb(255,241,172)","rgb(242,151,57)","rgb(252,209,62)","rgb(198,216,236)","rgb(162,179,219)"],
  ["rgb(222,234,247)","rgb(166,145,196)","rgb(210,221,125)","rgb(198,216,236)","rgb(255,241,172)","rgb(246,217,215)","rgb(241,154,164)","rgb(216,205,228)","rgb(241,154,164)","rgb(252,209,62)","rgb(255,249,179)"],
  ["rgb(132,109,174)","rgb(198,216,236)","rgb(216,205,228)","rgb(241,154,164)","rgb(216,205,228)","rgb(255,241,172)","rgb(255,241,172)","rgb(198,216,236)","rgb(255,241,172)","rgb(166,145,196)","rgb(198,216,236)","rgb(249,218,217)"],
  ["rgb(128,180,216)","rgb(252,209,62)","rgb(255,241,172)","rgb(246,217,215)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(246,217,215)","rgb(241,154,164)","rgb(242,129,132)","rgb(128,180,216)"],
  ["rgb(232,84,107)","rgb(166,145,196)","rgb(198,216,236)","rgb(255,241,172)","rgb(246,217,215)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,241,172)","rgb(255,241,172)","rgb(166,145,196)","rgb(252,209,62)","rgb(132,109,174)"],
  ["rgb(238,132,140)","rgb(252,209,62)","rgb(242,129,132)","rgb(216,205,228)","rgb(255,241,172)","rgb(255,241,172)","rgb(246,217,215)","rgb(246,217,215)","rgb(241,154,164)","rgb(128,177,55)","rgb(132,109,174)"],
  ["rgb(232,84,107)","rgb(198,216,236)","rgb(198,216,236)","rgb(255,241,172)","rgb(241,154,164)","rgb(255,241,172)","rgb(198,216,236)","rgb(255,241,172)","rgb(252,209,62)","rgb(166,145,196)","rgb(39,134,187)","rgb(162,179,219)"],
  ["rgb(162,179,219)","rgb(166,145,196)","rgb(210,221,125)","rgb(198,216,236)","rgb(252,209,62)","rgb(241,154,164)","rgb(166,145,196)","rgb(242,129,132)","rgb(128,180,216)","rgb(252,209,62)","rgb(238,132,140)"],
  ["rgb(238,132,140)","rgb(39,134,187)","rgb(128,180,216)","rgb(166,145,196)","rgb(128,180,216)","rgb(198,216,236)","rgb(252,209,62)","rgb(252,209,62)","rgb(166,145,196)","rgb(166,145,196)","rgb(238,132,140)","rgb(132,109,174)"],
  ["rgb(232,84,107)","rgb(240,155,165)","rgb(240,155,165)","rgb(255,252,228)","rgb(249,218,217)","rgb(240,155,165)","rgb(249,218,217)","rgb(249,218,217)","rgb(240,155,165)","rgb(240,155,165)","rgb(132,109,174)"],
  ["rgb(232,84,107)","rgb(238,132,140)","rgb(240,155,165)","rgb(255,252,228)","rgb(249,218,217)","rgb(249,218,217)","rgb(240,155,165)","rgb(255,252,228)","rgb(255,252,228)","rgb(255,252,228)","rgb(249,218,217)","rgb(222,234,247)"],
  ["rgb(238,132,140)","rgb(132,109,174)","rgb(249,218,217)","rgb(249,218,217)","rgb(255,252,228)","rgb(255,252,228)","rgb(249,218,217)","rgb(249,218,217)","rgb(255,252,228)","rgb(249,218,217)","rgb(222,234,247)"],
  ["rgb(132,109,174)","rgb(132,109,174)","rgb(238,132,140)","rgb(255,252,228)","rgb(238,132,140)","rgb(249,218,217)","rgb(240,155,165)","rgb(249,218,217)","rgb(240,155,165)","rgb(255,255,255)","rgb(255,255,255)","rgb(162,179,219)"],
  ["rgb(74,74,156)","rgb(238,132,140)","rgb(249,218,217)","rgb(238,132,140)","rgb(232,84,107)","rgb(240,155,165)","rgb(249,218,217)","rgb(238,132,140)","rgb(238,132,140)","rgb(249,218,217)","rgb(162,179,219)"],
  ["rgb(74,74,156)","rgb(224,54,74)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(224,54,74)","rgb(66,90,166)"],
  ["rgb(232,84,107)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(66,90,166)"],
  ["rgb(224,54,74)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(66,90,166)"],
  ["rgb(224,54,74)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(66,90,166)"],
  ["rgb(132,109,174)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(74,74,156)"],
  ["rgb(74,74,156)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(74,74,156)"],
  ["rgb(74,74,156)","rgb(224,54,74)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(224,54,74)","rgb(66,90,166)"],
  ["rgb(232,84,107)","rgb(232,84,107)","rgb(232,84,107)","rgb(240,155,165)","rgb(240,155,165)","rgb(240,155,165)","rgb(162,179,219)","rgb(222,234,247)","rgb(224,54,74)","rgb(232,84,107)","rgb(66,90,166)"],
  ["rgb(224,54,74)","rgb(240,155,165)","rgb(238,132,140)","rgb(240,155,165)","rgb(240,155,165)","rgb(238,132,140)","rgb(162,179,219)","rgb(222,234,247)","rgb(222,234,247)","rgb(238,132,140)","rgb(232,84,107)","rgb(66,90,166)"],
  ["rgb(224,54,74)","rgb(222,234,247)","rgb(238,132,140)","rgb(238,132,140)","rgb(222,234,247)","rgb(222,234,247)","rgb(232,84,107)","rgb(162,179,219)","rgb(162,179,219)","rgb(232,84,107)","rgb(66,90,166)"],
  ["rgb(132,109,174)","rgb(132,109,174)","rgb(162,179,219)","rgb(222,234,247)","rgb(222,234,247)","rgb(224,54,74)","rgb(224,54,74)","rgb(232,84,107)","rgb(162,179,219)","rgb(132,109,174)","rgb(66,90,166)","rgb(74,74,156)"],
  ["rgb(74,74,156)","rgb(162,179,219)","rgb(162,179,219)","rgb(162,179,219)","rgb(224,54,74)","rgb(132,109,174)","rgb(132,109,174)","rgb(224,54,74)","rgb(132,109,174)","rgb(132,109,174)","rgb(74,74,156)"],
  ["rgb(66,90,166)","rgb(240,155,165)","rgb(240,155,165)","rgb(224,54,74)","rgb(232,84,107)","rgb(126,60,146)","rgb(224,54,74)","rgb(224,54,74)","rgb(123,89,162)","rgb(132,109,174)","rgb(229,0,18)","rgb(0,70,155)"],
  ["rgb(224,54,74)","rgb(255,246,151)","rgb(240,155,165)","rgb(232,84,107)","rgb(123,89,162)","rgb(123,89,162)","rgb(224,54,74)","rgb(224,54,74)","rgb(132,109,174)","rgb(0,70,155)","rgb(0,70,155)"],
  ["rgb(224,54,74)","rgb(222,234,247)","rgb(222,234,247)","rgb(162,179,219)","rgb(238,132,140)","rgb(232,84,107)","rgb(240,155,165)","rgb(238,132,140)","rgb(238,132,140)","rgb(229,0,18)","rgb(229,0,18)","rgb(66,90,166)"],
  ["rgb(238,132,140)","rgb(222,234,247)","rgb(222,234,247)","rgb(162,179,219)","rgb(162,179,219)","rgb(255,252,228)","rgb(249,218,217)","rgb(238,132,140)","rgb(238,132,140)","rgb(238,132,140)","rgb(222,234,247)"],
  ["rgb(238,132,140)","rgb(255,255,255)","rgb(255,252,228)","rgb(255,252,228)","rgb(222,234,247)","rgb(249,218,217)","rgb(249,218,217)","rgb(249,218,217)","rgb(238,132,140)","rgb(240,155,165)","rgb(240,155,165)","rgb(249,218,217)"],
  ["rgb(249,218,217)","rgb(255,255,255)","rgb(255,252,228)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(249,218,217)","rgb(255,255,255)","rgb(255,255,255)","rgb(240,155,165)","rgb(249,218,217)"],
  ["rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,252,228)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)"],
  ["rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)"],
  ["rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)"],
  ["rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)"],
  ["rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)"],
  ["rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)"],
  ["rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)"],
  ["rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)","rgb(255,255,255)"]
];

var HEX_ADD_PALLET = [
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(247,204,200,0.27)","rgba(255,255,255,0.27)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(247,204,200,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(255,255,255,0.27)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(255,255,255,0.27)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(255,255,255,0.27)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(255,255,255,0.27)","rgba(255,255,255,0.27)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(255,255,255,0.27)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(255,255,255,0.27)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(255,255,255,0.27)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(255,255,255,0.27)","rgba(255,255,255,0.27)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"],
  ["rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)","rgba(0,0,0,0.00)"]
];


var HEX_WORKS = [
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,1,1,1,1,1,1,1,1,1,0],
  [0,1,1,1,1,1,1,1,1,1,1,0],
  [0,1,1,1,1,1,1,1,1,1,0],
  [0,1,1,1,1,1,1,1,1,1,1,0],
  [1,1,1,1,0,0,0,1,1,1,1],
  [0,1,1,1,1,0,0,1,1,1,1,0],
  [0,1,1,1,1,1,1,1,1,1,0],
  [0,1,1,1,1,1,1,1,1,1,1,0],
  [0,1,1,1,1,1,1,1,1,1,0],
  [0,1,1,1,1,1,1,1,1,1,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0]
];


var works  = [];
var selIdx = null;

// center of works [ 46 ][ 5 ]
var wcY = 46,
    wcX = 5;

var images = [];



//---------------------------------------------------------------------------------------------------- loading
$( function(){
  Array.prototype.remove = function( _element ){
    for( var i = 0; i < this.length; ++i ){
      if( this[ i ] == _element ) this.splice( i, 1 );
    }
  };

  function preload( _images, _progress ){
    var total = _images.length;
    $( _images ).each( function(){
      var src = this;
      $( '<img/>' ).attr( 'src', src )
                   .load( function(){
                     _images.remove( src );
                     _progress( total, total - images.length );
                   } );
    } );
  }

  var targetPct  = 0;
  var currentPct = 0;
  var imgSrc     = [];
  $( '.work' ).each( function( _index ){
    imgSrc[ _index ] = $( this ).data( "image" );
  } );

  preload( imgSrc, function( _total, _loaded ){
    targetPct = Math.ceil( ( _loaded / _total ) * 100 );
  } );

  var lCanvas = document.getElementById( 'loadingCanvas' );
  if( !lCanvas || !lCanvas.getContext ){
    return false;
  }

  window.addEventListener( 'resize', lResize, false );

  function lResize(){
  	clearTimeout( lQueue );
  	lQueue = setTimeout( function(){
      lCanvas.width  = window.innerWidth;
      lCanvas.height = window.innerHeight;
  	}, 20 );
  }

  var lCtx       = lCanvas.getContext( '2d' );
  lCanvas.width  = window.innerWidth;
  lCanvas.height = window.innerHeight;
  var r          = 40;
  var inR        = r * Math.cos( Math.PI / HEX_NUM_ANGLES );
  var a          = ( Math.PI * 2 ) / HEX_NUM_ANGLES;
  var cs         = [ "rgb( 232, 84, 107 )", "rgb( 240, 155, 165 )", "rgb( 116, 131, 192 )", "rgb( 249, 218, 217 )", "rgb( 255, 246, 151 )", "rgb( 162, 179, 219 )" ];

  var timer = window.setInterval( function(){
    // loading
    if( currentPct < 100 ){
      if( currentPct < targetPct ){
        ++currentPct;
        $( '#load_text' ).html( currentPct + '%' );

        lCtx.clearRect( 0, 0, lCanvas.width, lCanvas.height );

        var cx = lCanvas.width / 2;
        var cy = lCanvas.height / 2;

        for( var i = 0; i < HEX_NUM_ANGLES; ++i ){
          var x   = cx + ( Math.cos( i * a ) * inR * 2 );
          var y   = cy + ( Math.sin( i * a ) * inR * 2 );

          if( currentPct > ( i * Math.floor( 100 / HEX_NUM_ANGLES ) ) ){
            lCtx.fillStyle = cs[ i ];
            drawHexIndicator( x, y, r * 0.9, i * a );

            if( i == 5 ){
              lCtx.fillStyle = "rgba( 255, 255, 255, 0.27 )";
              drawHexIndicator( x, y, r * 0.9 * 0.7, i * a );
            }
          }
        }
      }
    }
    // load complete
    else{
      window.clearInterval( timer );

      $( '#loadWrapper' ).fadeOut( 'slow', function(){
        $( '#wrapper' ).fadeIn( 'slow' );

        init();
      } );
    }
  }, 20 );

  function drawHexIndicator( _x, _y, _r, _rot ){
    lCtx.save();
    lCtx.translate( _x, _y );
    lCtx.rotate( _rot );

    drawHexPolygon( lCtx, _r );
    lCtx.fill();

    lCtx.restore();
  }
} );


//---------------------------------------------------------------------------------------------------- init
function init(){
  $( '.work' ).each( function( index ){
    images[ index ] = new Image();
    images[ index ].src = $( this ).data( "image" );
  } );

  scrollTop = $( document ).scrollTop();

  $( document ).scroll( function(){
    // $( this ).scrollTop( 200 );
    if( selIdx == null ) scrollTop = $( this ).scrollTop();
  } );


	canvas = document.getElementById( 'canvas' );

	if( !canvas || !canvas.getContext ){
		return false;
	}

	ctx = canvas.getContext( '2d' );

	// set canvas size
	setCanvasSize();

	// resize event
	window.addEventListener( 'resize', resize, false );
  // mouse event
	window.addEventListener( 'mousemove', mouseMove );

	// mouseClick
	window.addEventListener( 'click', mouseClick );

  var requestAnimationFrame = window.requestAnimationFrame       ||
                              window.webkitRequestAnimationFrame ||
                              window.mozRequestAnimationFrame    ||
                              window.oRequestAnimationFrame      ||
                              window.msRequestAnimationFrame     ||
                              window.setTimeout;
  window.requestAnimationFrame = requestAnimationFrame;

  draw();
}


//---------------------------------------------------------------------------------------------------- resize
function resize(){
	clearTimeout( queue );
	queue = setTimeout( function(){
		setCanvasSize();
	}, wait );
}


//---------------------------------------------------------------------------------------------------- setCanvasSize
function setCanvasSize(){
	canvas.width   = window.innerWidth;
	canvas.height  = window.innerHeight;
	cw             = canvas.width;
	ch             = canvas.height;
	hw             = cw / 2;
	hh             = ch / 2;

  HEX_MAX_IN_RADIUS = ( cw / HEX_BG_PALLET[ 0 ].length ) / 2;
  HEX_MAX_RADIUS    = HEX_MAX_IN_RADIUS / Math.cos( Math.PI / 6 );

  // resize list height
  $( '.content_title' ).css( "height", ( 13 * ( HEX_MAX_RADIUS * 1.5 ) ) - HEX_MAX_RADIUS * 0.5 );
  $( '.content_about' ).css( "height", ( 13 * ( HEX_MAX_RADIUS * 1.5 ) ) );
  $( '.content_party' ).css( "height", ( 14 * ( HEX_MAX_RADIUS * 1.5 ) ) );
  $( '.content_works' ).css( "height", ( 14 * ( HEX_MAX_RADIUS * 1.5 ) ) );
  $( '.content_access' ).css( "height", ( 16 * ( HEX_MAX_RADIUS * 1.5 ) ) );
  $( '.content_contact' ).css( "height", ( 12 * ( HEX_MAX_RADIUS * 1.5 ) ) );

  // setup works
  var idx = 0;
  for( var y = 0; y < HEX_WORKS.length; ++y ){
    radius[ y ] = 0.0;

    for( var x = 0; x < HEX_WORKS.length; ++x ){
      if( HEX_WORKS[ y ][ x ] == 1 ){
        works[ idx ] = { y: y, x: x };
        ++idx;
      }
    }
  }
}


//---------------------------------------------------------------------------------------------------- mouseMove
function mouseMove( e ){
	mouseX = e.clientX;
	mouseY = e.clientY;
}


//---------------------------------------------------------------------------------------------------- mouseClick
function mouseClick(){
  // popup
  if( selIdx != null ){
    // close button
    var btnX = cw - HEX_MAX_RADIUS * 1.5;
    var btnY = HEX_MAX_RADIUS;
    var lr   = HEX_MAX_IN_RADIUS * 0.5;
    ctx.beginPath();
    ctx.arc( btnX, btnY, lr, 0, Math.PI * 2, false );
    ctx.closePath();
    if( ctx.isPointInPath( mouseX, mouseY ) ){
      selIdx    = null;
      selRadius = 0.0;

      // resume scroll
      $( '#contents' ).removeClass( 'noScroll' ).css( 'top', 0 );
      $( document ).scrollTop( scrollTop );
      return;
    }

    // left arrow
    if( selIdx > 0 ){
      ctx.beginPath();
      ctx.arc( HEX_MAX_RADIUS * 1.2, hh, lr * 2.0, 0, Math.PI * 2, false );
      ctx.closePath();
      if( ctx.isPointInPath( mouseX, mouseY ) ){
        selRadius = 0.0;
        --selIdx;
      }
    }
    // right arrow
    if( selIdx < ( works.length - 1 ) ){
      ctx.beginPath();
      ctx.arc( cw - ( HEX_MAX_RADIUS * 1.2 ), hh, lr * 2.0, 0, Math.PI * 2, false );
      ctx.closePath();
      if( ctx.isPointInPath( mouseX, mouseY ) ){
        selRadius = 0.0;
        ++selIdx;
      }
    }
    return;
  }

  // select
  var bSelect = false;
  for( var i = 0; i < works.length; ++i ){
    var y  = works[ i ].y;
    var x  = works[ i ].x;
    var py = -scrollTop + ( y * ( HEX_MAX_RADIUS * 1.5 ) );
    var px = ( y % 2 == 1 ) ? ( x * ( HEX_MAX_IN_RADIUS * 2 ) ): HEX_MAX_IN_RADIUS + ( x * ( HEX_MAX_IN_RADIUS * 2 ) );

    ctx.save();
    ctx.translate( px, py );
    drawHexPolygon( ctx, radius[ y ] );
    if( ctx.isPointInPath( mouseX, mouseY ) ){
      selIdx = i;
      bSelect = true;

      // disable scroll
      $( '#contents' ).addClass( 'noScroll' ).css( 'top', -scrollTop );
    }
    ctx.restore();
  }

  if( !bSelect ){
    selIdx    = null;
    selRadius = 0.0;
  }
}


//---------------------------------------------------------------------------------------------------- draw
function draw(){
  requestAnimationFrame( draw );

	ctx.globalAlpha = 1.0;
	ctx.fillStyle   = "rgb( 255, 255, 255 )";
	ctx.fillRect( 0, 0, cw, ch );

  for( var y = 0; y < HEX_BG_PALLET.length; ++y ){
    var py = -scrollTop + ( y * ( HEX_MAX_RADIUS * 1.5 ) );

    // update radius
    if( ( py >= -( HEX_MAX_RADIUS ) ) && ( py <= ch + HEX_MAX_RADIUS ) ){
      if( radius[ y ] > HEX_MAX_RADIUS - 0.1 ){
        radius[ y ] = HEX_MAX_RADIUS;
      }
      else{
        radius[ y ] += ( HEX_MAX_RADIUS - radius[ y ] ) / 12;
      }
    }
    else{
      if( radius[ y ] < 0.1 ){
        radius[ y ] = 0.0;
      }
      else{
        radius[ y ] += ( 0.0 - radius[ y ] ) / 12;
      }
    }

    // draw hexagons
    for( var x = 0; x < HEX_BG_PALLET[ y ].length; ++x ){
      if( ( HEX_BG_PALLET[ y ][ x ] == "rgb(255,255,255)" ) || ( HEX_WORKS[ y ][ x ] == 1 ) ){
        continue;
      }

      var px = ( y % 2 == 1 ) ? ( x * ( HEX_MAX_IN_RADIUS * 2 ) ): HEX_MAX_IN_RADIUS + ( x * ( HEX_MAX_IN_RADIUS * 2 ) );

      // bg
      ctx.fillStyle   = HEX_BG_PALLET[ y ][ x ];
      ctx.lineWidth   = 0.0;
      ctx.globalAlpha = 1.0;
      drawHexagon( px, py, radius[ y ] );

      // add
      if( HEX_ADD_PALLET[ y ][ x ] !== "rgba(0,0,0,0.00)" ){
        ctx.fillStyle   = HEX_ADD_PALLET[ y ][ x ];
        drawHexagon( px, py, radius[ y ] * 0.7 );
      }
    }
  }

  // works
  ctx.strokeStyle = "rgb( 255, 255, 255 )";
  ctx.lineWidth   = HEX_MAX_RADIUS / 6;
  for( var i = 0; i < works.length; ++i ){
    var y  = works[ i ].y;
    var x  = works[ i ].x;
    var py = -scrollTop + ( y * ( HEX_MAX_RADIUS * 1.5 ) );
    var px = ( y % 2 == 1 ) ? ( x * ( HEX_MAX_IN_RADIUS * 2 ) ): HEX_MAX_IN_RADIUS + ( x * ( HEX_MAX_IN_RADIUS * 2 ) );
    ctx.fillStyle = HEX_BG_PALLET[ y ][ x ];
    drawImageHexagon( px, py, radius[ y ], images[ i % images.length ], ( i == selIdx ) );
  }

  // select
  if( selIdx != null ){
    ctx.fillStyle = "rgba( 0, 0, 0, 0.6 )";
    ctx.fillRect( 0, 0, cw, ch );

    // update select radius
    if( selRadius > ( ( HEX_MAX_RADIUS * 3 ) - 0.1 ) ){
      selRadius = HEX_MAX_RADIUS * 3;
    }
    else{
      selRadius += ( ( HEX_MAX_RADIUS * 3 ) - selRadius ) / 12;
    }

    // center of window
    var cy = hh + HEX_MAX_RADIUS * 0.77;
    var cx = hw;

    var r  = HEX_MAX_RADIUS * 3.1;
    var _r = selRadius;
    var a  = ( Math.PI * 2 ) / 3;
    var x  = [];
    var y  = [];
    for( var i = 0; i < 3; ++i ){
      x[ i ] = cx + ( Math.cos( ( i * a ) - Math.PI / 2 ) * r );
      y[ i ] = cy + ( Math.sin( ( i * a ) - Math.PI / 2 ) * r );
    }

    var i = images[ selIdx % images.length ];

    // image
    ctx.save();
    ctx.translate( x[ 0 ], y[ 0 ] );
    drawHexPolygon( ctx, _r );
    ctx.clip();
    ctx.drawImage( i, 0, 0, i.width, i.height, -_r, -_r, _r * 2, _r * 2 );
    ctx.restore();

    // right
    ctx.fillStyle = "rgb( 255, 255, 255 )";
    drawHexagon( x[ 1 ], y[ 1 ], _r );

    //left
    drawHexagon( x[ 2 ], y[ 2 ], _r );

    // close button
    var btnX = cw - HEX_MAX_RADIUS * 1.5;
    var btnY = HEX_MAX_RADIUS;
    var lr   = HEX_MAX_IN_RADIUS * 0.5;
    ctx.beginPath();
    ctx.arc( btnX, btnY, lr, 0, Math.PI * 2, false );
    ctx.closePath();

    ctx.lineWidth = ( ctx.isPointInPath( mouseX, mouseY ) ) ? 2.5: 1;
    ctx.strokeStyle = "rgb( 255, 255, 255 )";
    drawCross( btnX, btnY, lr );
    ctx.lineWidth = 1;

    // left arrow
    if( selIdx > 0 ){
      ctx.beginPath();
      ctx.arc( HEX_MAX_RADIUS * 1.2, hh, lr * 2.0, 0, Math.PI * 2, false );
      ctx.closePath();
      ctx.lineWidth = ( ctx.isPointInPath( mouseX, mouseY ) ) ? 2.5: 1;

      drawArrow( HEX_MAX_RADIUS, hh, lr * 1.5, true );
    }

    // right arrow
    if( selIdx < ( works.length - 1 ) ){
      ctx.beginPath();
      ctx.arc( cw - HEX_MAX_RADIUS * 1.2, hh, lr * 2.0, 0, Math.PI * 2, false );
      ctx.closePath();
      ctx.lineWidth = ( ctx.isPointInPath( mouseX, mouseY ) ) ? 2.5: 1;

      drawArrow( cw - HEX_MAX_RADIUS, hh, lr * 1.5, false );
      ctx.lineWidth = 1;
    }
  }
}

//---------------------------------------------------------------------------------------------------- drawImageHexagon
function drawImageHexagon( _x, _y, _r, _i, _s ){
  ctx.save();

  ctx.translate( _x, _y );
  drawHexPolygon( ctx, _r );
  ctx.fill();
  ctx.stroke();

  if( _s ){
    drawHexPolygon( ctx, _r - ctx.lineWidth / 2 );
    ctx.clip();
    ctx.drawImage( _i, 0, 0, _i.width, _i.height, -_r, -_r, _r * 2, _r * 2 );
  }
  else{
    if( selIdx == null ){
      if( ctx.isPointInPath( mouseX, mouseY ) ){
        drawHexPolygon( ctx, _r - ctx.lineWidth / 2 );
        ctx.clip();
        ctx.drawImage( _i, 0, 0, _i.width, _i.height, -_r, -_r, _r * 2, _r * 2 );
      }
    }
  }

  ctx.restore();
}


//---------------------------------------------------------------------------------------------------- drawHexagon
function drawHexagon( _x, _y, _r ){
  ctx.save();
  ctx.translate( _x, _y );

  drawHexPolygon( ctx, _r );
  ctx.fill();

  ctx.restore();
}


//---------------------------------------------------------------------------------------------------- drawHexPolygon
function drawHexPolygon( _ctx, _r ){
	var angle  = ( ( Math.PI * 2 ) / HEX_NUM_ANGLES );

	_ctx.beginPath();
	for( var i = 0; i <= HEX_NUM_ANGLES; ++i ){
		var a = ( i + 0.5 ) * angle;
		var x = Math.cos( a ) * _r,
		    y = Math.sin( a ) * _r;

		if( i == 0 ){
			_ctx.moveTo( x, y );
		}
		else{
			_ctx.lineTo( x, y );
		}
	}
	_ctx.closePath();
}


//---------------------------------------------------------------------------------------------------- drawCross
function drawCross( _x, _y, _r ){
  ctx.save();
  ctx.translate( _x, _y );

  ctx.beginPath();
  ctx.moveTo( Math.cos( Math.PI * 1.25 ) * _r, Math.sin( Math.PI * 1.25 ) * _r );
  ctx.lineTo( Math.cos( Math.PI * 0.25 ) * _r, Math.sin( Math.PI * 0.25 ) * _r );
  ctx.closePath();
  ctx.stroke();

  ctx.beginPath();
  ctx.moveTo( Math.cos( Math.PI * 1.75 ) * _r, Math.sin( Math.PI * 1.75 ) * _r );
  ctx.lineTo( Math.cos( Math.PI * 0.75 ) * _r, Math.sin( Math.PI * 0.75 ) * _r );
  ctx.closePath();
  ctx.stroke();

  ctx.restore();
}


//---------------------------------------------------------------------------------------------------- drawCross
function drawArrow( _x, _y, _r, _l ){
  ctx.save();
  ctx.translate( _x, _y );
  ctx.scale( ( _l ) ? 1: -1, 1 );

  ctx.beginPath();
  ctx.moveTo( 0, 0 );
  ctx.lineTo( Math.cos( -( Math.PI / 3 ) ) * _r, Math.sin( -( Math.PI / 3 ) ) * _r );
  ctx.closePath();
  ctx.stroke();

  ctx.beginPath();
  ctx.moveTo( 0, 0 );
  ctx.lineTo( Math.cos( Math.PI / 3 ) * _r, Math.sin( Math.PI / 3 ) * _r );
  ctx.closePath();
  ctx.stroke();

  ctx.restore();
}
